<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

  <head>
   <title>Resultados</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link href="../static/css/bootstrap.css" th:href="@{/css/bootstrap.min.css}" rel="stylesheet" media="screen"/> 
 
 
     <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript" th:inline="javascript">

      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawChart);

      // Set chart options
      var options = {'title':'',
                     'width':400,
                     'height':300};

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawChart() {
    	  
    	  
    	  var pollingStations = /*[[${pollingStations}]]*/ [];
    	  
    	  pollingStations.forEach(function (v){
        	  $.ajax({
    	          url: "stadistic_pollingstation_json/" + v,
    	          dataType: "json",
    	          success: function (json) {
    	              // Create the data table.
    	              var data = new google.visualization.DataTable(json);

    	              // Instantiate and draw our chart, passing in some options.
    	              var chart = new google.visualization.PieChart(document.getElementById('chart_div_' + v));
    	              chart.draw(data, options);
    	          }
              });
    	  });
    	  

    	  $.ajax({
	          url: "stadistic_json",
	          dataType: "json",
	          success: function (json) {
	              // Create the data table.
	              var data = new google.visualization.DataTable(json);

	              // Instantiate and draw our chart, passing in some options.
	              var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
	              chart.draw(data, options);
	          }
          });
    	  
          // Create the data table.
          var data = new google.visualization.DataTable()
          data.addColumn('string', 'Topping');
          data.addColumn('number', 'Slices');
          
          
          data.addRows([
                        ['Mushrooms', 3],
                        ['Onions', 1],
                        ['Olives', 1],
                        ['Zucchini', 1],
                        ['Pepperoni', 2]
                      ]);

          

          // Instantiate and draw our chart, passing in some options.
          var chart = new google.visualization.PieChart(document.getElementById('chart'));
          chart.draw(data, options);
	        
      }
    </script>
  
  </head>



<body>


	<h1 align="center">Resultado de las Votaciones</h1>
	<br />
	<br />
	<div>
	<!--Tata de resultado total-->
	
	<div style="float:left;width:50%;">
	<h2 >Resultado de las elecciones</h2>
	<div id="chart_div"></div>
    </div>
    
    
	<div th:each="pollingStation: ${pollingStations}" style="float:right;width:50%;">
		
<h2>Numero de votos por colegio</h2>
		<div th:id="${'chart_div_' + pollingStation}" ></div>
	</div>
	</div>
	<br />
	<br />
	<br />
	<!--  
	Prueba del segundo modo de muestra de datos, sin grÃ¡ficos
	<div th:each="votes: ${votesPartyPStation}">
    	<h2 th:text="'Colegio electoral:'+ ${votes[0]}" ></h2>
    	<h2 th:text="'Partido:'+ ${votes[1]}" ></h2>
      <h2 th:text="'Votos:'+ ${votes[2]}" ></h2>
		<br/>
		<div th:id="${'chart_div_' + votes}"></div>
    </div>
    -->

	<h2>Resultado votaciones por colegio electoral</h2>
	Selecciona el colegio electoral
	
	<form action="#" th:action="@{/st}" th:object="${vote}" method="post">
	<select name="Colegios" onchange="myFunction()">
	<div th:each="c: ${colegios}">
	<h2 th:text="'Colegio electoral:'+ ${c[0]}" ></h2>
		<option th:value="${c[0]}" ><p th:text="'' + ${c[0]}" /></option>
		
	</div>	
	</select>
    <p><input type="submit" value="Buscar" /></p>
	</form>
	
	<div id="chart"></div>


</body>
</html>